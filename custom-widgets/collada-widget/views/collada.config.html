<div ng-controller="colladaConfig as collada">
    <hr/>

    <label>3D Collada File (*.DAE)</label>
    <div>
        <input class="form-control" type="text" ng-model="collada.configClone.fileName" readonly/>
    </div>
    <div>
        <input class="form-control" type="file" c8y-on-change="collada.onNewFileSelected(event)" accept=".dae,model/vnd.collada+xml" ng-disabled="collada.uploading"/>
    </div>
    <div ng-if="collada.uploading">Uploading...</div>
    <hr/>

    <label>Variables</label>
    <table class="table table-sm">
        <colgroup>
            <col style="width:auto">
            <col style="width:15%">
            <col style="width:20%">
            <col style="width:65%">
        </colgroup>
        <thead>
            <tr>
                <th><!-- Add/Remove icon --></th>
                <th>Name</th>
                <th>Target</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="variable in collada.configClone.variables">
                <td class="align-middle"><a class="btn btn-default btn-xs rounded-pill flex-right" title="{{'Delete Variable' | translate}}" ng-click="collada.removeVariable($index)"><i c8y-icon="minus"></i></a></td>
                <td><input class="form-control" ng-model="variable.name"/></td>
                <td><select class="form-control" ng-options="device.id as device.name for device in collada.variableTargets" ng-model="variable.deviceId"></select></td>
                <td class="flex">
                    <input class="form-control flex-grow" ng-model="variable.constantValue" ng-if="!variable.deviceId"/>
                    <a class="btn btn-default rounded-pill flex-grow" ng-if="variable.deviceId && !variable.schema" ng-click="collada.setMapping(variable)">Configure...</a>
                    <a class="btn btn-primary rounded-pill flex-right showOnHover" ng-if="variable.deviceId && !variable.schema" ng-click="collada.setMapping(variable)"><i c8y-icon="pencil"></i></a>
                    <a class="btn btn-default rounded-pill flex-grow" ng-if="variable.deviceId && variable.schema" ng-click="collada.editComputedProperty(variable)"><i c8y-icon="bolt"></i>{{variable.schema.label}}</a>
                    <a class="btn btn-danger rounded-pill flex-right showOnHover" title="{{'Clear mapping' | translate}}" ng-if="variable.deviceId && variable.schema" ng-click="collada.clearMapping(variable)"><i c8y-icon="scissors"></i></a>
                </td>
            </tr>
            <tr>
                <td class="align-middle"><a class="btn btn-primary btn-xs rounded-pill flex-right" title="{{'Add Variable' | translate}}" ng-click="collada.addVariable()"><i c8y-icon="plus"></i></a></td>
            </tr>
        </tbody>
    </table>
    <hr/>

    <label>Properties</label>
    <table class="table table-sm">
        <thead>
            <tr>
                <th><!-- Add/Remove icon --></th>
                <th>Property</th>
                <th>Expression</th>
                <th>Current Value</th>
                <th>Min</th>
                <th>Max</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="property in collada.configClone.properties">
                <td class="align-middle"><a class="btn btn-default btn-xs rounded-pill flex-right" title="{{'Delete Property' | translate}}" ng-click="collada.removeProperty($index)"><i c8y-icon="minus"></i></a></td>
                <td><select class="form-control" ng-options="p as p.name group by p.type for p in collada.configClone.availableProperties track by (p.type + ':' + p.name)" ng-init="selectedProperty = property" ng-model="selectedProperty" ng-change="collada.propertySelected(property, selectedProperty)"></select></td>
                <td><input class="form-control" type="text" ng-model="property.expression"/></td>
                <td><input class="form-control" type="text" ng-value="collada.getPropertyValue(property)" readonly/></td>
                <td><input class="form-control" type="text" ng-value="property.min" readonly/></td>
                <td><input class="form-control" type="text" ng-value="property.max" readonly/></td>
            </tr>
            <tr>
                <td class="align-middle"><a class="btn btn-primary btn-xs rounded-pill flex-right" title="{{'Add Property' | translate}}" ng-click="collada.addProperty()"><i c8y-icon="plus"></i></a></td>
            </tr>
        </tbody>
    </table>
    <hr/>

    <button type="button" class="btn-toggle-panel" ng-click="moreOptsCollapsed = !moreOptsCollapsed" ng-class="{'open': moreOptsCollapsed}">More Options <i c8y-icon="chevron-down"></i></button>
    <div uib-collapse="!moreOptsCollapsed">
        <div class="row">
            <div class="col-xs-2 text-right"><label>Background Color</label></div>
            <div class="col-xs-2"><input class="form-control" type="color" ng-model="collada.configClone.bgColor"/></div>
            <div class="col-xs-2 text-right"><label>Show Grid</label></div>
            <div class="col-xs-2"><input class="form-control" type="checkbox" ng-model="collada.configClone.showGrid"/></div>
            <div class="col-xs-2 text-right"><label>Show Stats</label></div>
            <div class="col-xs-2"><input class="form-control" type="checkbox" ng-model="collada.configClone.showStats"/></div>
        </div>
        <label>Label</label>
        <textarea class="form-control" ng-model="collada.configClone.label"></textarea>
    </div>
</div>